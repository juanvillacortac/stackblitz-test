<div class="card">
    <div class="p-d-flex p-ai-center p-jc-between p-flex-column p-flex-md-row">
        <div class="p-fluid p-col-12 p-md-4 p-lg-4">
          <!--<label *ngIf="!showFilters" id="filterTitle">Empresas</label>-->
          <h4 *ngIf="!showFilters" id="filterTitle">Programación individual</h4>
        </div>
        <div class="p-d-flex p-ai-center p-jc-end p-flex-column p-flex-md-row">
            <div>
              <button pButton pRipple icon="pi pi-filter" class="p-ml-2 p-button-help" [ngClass]="{'p-button-danger':showFilters}" 
              (click)="showFilters=!showFilters" pTooltip="Filtros" tooltipPosition="top"></button>
            </div>
        </div>
    </div>   
    <app-holiday-individual-programming-filter (onSearch)="search()" [expanded]="showFilters" [filters]="holidayIndividualProgramationFilter" [loading]="loading"></app-holiday-individual-programming-filter>
</div>
<div id="miniCardDatos" class="card">
  <div class="p-col-12 p-md-6 p-lg-4"><h6>Información del trabajador</h6></div>
  <div *ngIf="holidaysIndividualModel && holidaysIndividualModel.idLaborRelationship != 0" class="p-fluid p-grid p-mt-1">
    <div id="personalFont" class="p-col-12 p-md-9 p-mb-1 ">
      <span>{{holidaysIndividualModel.employeeFirstName}} {{holidaysIndividualModel.employeeSecondName}} {{holidaysIndividualModel.employeeLastName}} {{holidaysIndividualModel.employeeSecondLastName}}</span>
  </div>
  <div id="personalFontSub" class="p-col-12 p-md-9 p-mb-1">
      <span>{{holidaysIndividualModel.jobPosition}}</span>
  </div>
  <div id="personalFontID" class="p-col-12 p-md-9 p-mb-1">
      <span>Código:  {{holidaysIndividualModel.employmentCode}} | </span>
      <span>Identidad:   {{holidaysIndividualModel.identifier}} - {{holidaysIndividualModel.documentNumber}}</span>
  </div>
  <div id="personalFontID" class="p-col-12 p-md-9 p-mb-1">
    <span>Sucursal: {{holidaysIndividualModel.branchOffice}}</span>
  </div>
<!--       <div class="p-col-12 p-md-6 p-lg-4 p-pl-3 p-pr-3 p-mb-2">
          <label for="" class="p-mr-2">Documento: </label>
          <span>{{holidaysIndividualModel.identifier}}-{{holidaysIndividualModel.documentNumber}}</span>
      </div>
      <div class="p-col-12 p-md-6 p-lg-4 p-pl-3 p-pr-3 p-mb-2">
          <label for="" class="p-mr-2">Nombres: </label>
          <span>{{holidaysIndividualModel.employeeFirstName}} {{holidaysIndividualModel.employeeSecondName}}</span>
      </div>
      <div class="p-col-12 p-md-6 p-lg-4 p-pl-3 p-pr-3 p-mb-2">
          <label for="" class="p-mr-2">Apellidos: </label>
          <span>{{holidaysIndividualModel.employeeLastName}} {{holidaysIndividualModel.employeeSecondLastName}}</span>
      </div>
      <div class="p-col-12 p-md-6 p-lg-4 p-pl-3 p-pr-3">
          <label for="" class="p-mr-2">Código: </label>
          <span>{{holidaysIndividualModel.employmentCode}}</span>
      </div>
      <div class="p-col-12 p-md-6 p-lg-4 p-pl-3 p-pr-3">
          <label for="" class="p-mr-2">Sucursal: </label>
          <span>{{holidaysIndividualModel.branchOffice}}</span>
      </div>
      <div class="p-col-12 p-md-6 p-lg-4 p-pl-3 p-pr-3">
          <label for="" class="p-mr-2">Empresa: </label>
          <span>{{holidaysIndividualModel.company}}</span>
      </div> -->
      <div class="p-col-3 p-md-offset-5 p-md-3 p-lg-6 p-lg-offset-6 container-button p-pr-0">
        <button pButton pRipple label="Saldos" (click)="op.toggle($event)" [disabled]="isBtnBalanceDisable" icon="pi pi-eye" class="p-button-secondary secondary"></button>
      </div>
      <!-- Star Overlay Panel Banlance -->
      <ng-container >
        <p-overlayPanel #op [showCloseIcon]="true" [style]="{width: '450px'}">
          <div class="widget-team">
            <h5 style="padding-left: 0rem;">Saldo de vacaciones</h5>
            <h6>Trabajador: <span class="customer-badge status-new">{{holidaysIndividualModel.employeeFirstName}} {{holidaysIndividualModel.employeeLastName}}</span></h6>
            <ul>
              <li>
                <div class="p-grid member">
                  <div class="p-col-7 team-box">
                    <div>
                      <h6 class="team-member">Según antigüedad para año en curso: <span>{{holidaysIndividualModel.balance.holidaysTotal}} Días correspondientes</span></h6>
                    </div>
                  </div>
                </div>
              </li>
              <li>
                <div class="p-grid member">
                  <div class="p-col-7 team-box">
                    <div>
                      <h6 class="team-member">Según antigüedad hasta ciclo anterior: <span>{{holidaysIndividualModel.balance.accumulatedCyclePrevious}} Días correspondientes</span></h6>
                    </div>
                  </div>
                </div>
              </li>
              <li>
                <div class="p-grid member">
                  <div class="p-col-7 team-box">
                    <div>
                      <h6 class="team-member">Programadas: <span>{{holidaysIndividualModel.balance.programmed}} Días</span></h6>
                    </div>
                  </div>
                </div>
              </li>
              <li>
                <div class="p-grid member">
                  <div class="p-col-7 team-box">
                    <div>
                      <h6 class="team-member">No programadas: <span>{{holidaysIndividualModel.balance.noProgrammed}} Días</span></h6>
                    </div>
                  </div>
                </div>
              </li>
              <li>
                <div class="p-grid member">
                  <div class="p-col-7 team-box">
                    <div>
                      <h6 class="team-member">Vencidas: <span>{{holidaysIndividualModel.balance.expired}} Días</span></h6>
                    </div>
                  </div>
                </div>
              </li>
              <li>
                <div class="p-grid member">
                  <div class="p-col-7 team-box">
                    <div>
                      <h6 class="team-member">Disfrutadas: <span>{{holidaysIndividualModel.balance.enjoyed}} Días</span></h6>
                    </div>
                  </div>
                </div>
              </li>
              <li>
                <div class="p-grid member">
                  <div class="p-col-7 team-box">
                    <div>
                      <h6 class="team-member">Días adicionales: <span>{{holidaysIndividualModel.balance.additionalDays}} Días</span></h6>
                    </div>
                  </div>
                </div>
              </li>
            </ul>
          </div>
        </p-overlayPanel>
      </ng-container>
      <!-- End Overlay Panel Banlance -->
    </div>
    <p-messages severity="info" *ngIf="holidaysIndividualModel && holidaysIndividualModel.idLaborRelationship == 0" >
      <ng-template pTemplate>
        <div class="p-ml-2">No existen resultados que coincidan con la búsqueda.</div>
      </ng-template>
    </p-messages>
  </div>
<!--  Star Table -->
<div class="card" *ngIf="holidaysIndividualModel && holidaysIndividualModel.idLaborRelationship != -1">
  <p-table [resizableColumns]="false" styleClass="p-datatable-responsive-demo p-datatable p-component p-datatable-hoverable-rows" 
      #dt [columns]="displayedColumns" [rowHover]="true" [value]="holidayCycle" [paginator]="true" [rows]="10" [showCurrentPageReport]="true" 
      currentPageReportTemplate="Mostrando {first} hasta {last} de {totalRecords} registros" [rowsPerPageOptions]="[10,25,50]" >
      <ng-template pTemplate="header" let-columns>
        <tr>
          <ng-container *ngFor="let col of columns">
            <th [ngStyle]="{'display': col.display, 'overflow-wrap': 'break-word' }" pResizableColumn [pSortableColumn]="col.field">
              {{col.header}}
              <p-sortIcon [field]="col.field"></p-sortIcon>
            </th>
          </ng-container>  
          <th></th>    
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-holidayCycle let-columns="columns" let-index="rowIndex">
        <tr>
          <ng-container *ngFor="let col of columns">
            <td [ngStyle]="{'display': col.display,'overflow-wrap': 'break-word'}">
              <span>{{col.template(holidayCycle)}} </span>
            </td>
          </ng-container>
          <td>
            <button *ngIf="holidayCycle.idStatus == 83 && this.userPermissions.allowed(this.permissionsIDs.MANAGE_HOLIDAY_HCM_PERMISSION_ID)" pButton pRipple type="button" icon="pi pi-plus" (click)="editHolidayCycle(index)" class="p-button-rounded p-button-success p-mr-2" pTooltip="Crear nuevo" tooltipPosition="top" placeholder="Top"></button>
            <button *ngIf="holidayCycle.idStatus == 84 && this.userPermissions.allowed(this.permissionsIDs.MANAGE_HOLIDAY_HCM_PERMISSION_ID)" pButton pRipple type="button" icon="pi pi-pencil" (click)="editHolidayCycle(index)"  class="p-button-rounded p-button-success p-mr-2" pTooltip="Editar" tooltipPosition="top" placeholder="Top"></button>
          </td>
        </tr>
      </ng-template> 
      <ng-template pTemplate="footer" let-columns>
        <ng-container>
          <tr *ngIf="holidayCycle.length == 0" >
            <td [ngStyle]="{'text-align': 'center'}" [attr.colspan]="columns.length+1">
            
            </td>
          </tr>
        </ng-container>
      </ng-template>
    </p-table>
    <!-- End Table -->
</div>

<app-holiday-individual-programming-panel *ngIf="showPanel" [data]="holidayCycleObject" [model]="holidaysIndividualModel" [showDialog]="showPanel" (backUnChange)="resetValues()" (saveData)="saveHolidayProgramming($event)"></app-holiday-individual-programming-panel>
