<p-dialog (onShow)="onShow()" (onHide)="onHide()" header="Dirección" [(visible)]="visible" [style]="{width:'75%'}" [modal]="true" class="address-dialog">
    <div class="p-grid">
        <div class="p-col-12">             
            <div class="p-fluid p-grid p-formgrid">
                <div class="p-field p-col-12 p-sm-6 p-md-4 p-lg-3 p-xl-3 p-mt-1">
                    <label>País <span [ngStyle]="{'color':'red'}">*</span></label>                    
                    <p-dropdown [(ngModel)]="address.idCountry" [class]="submitted && address.idCountry <= 0 ? 'ng-dirty ng-invalid' : ''" [options]="countriesList" (onChange)="changeloadStates(address.idCountry)" placeholder="Seleccione..." appendTo="body" [filter]="true" emptyFilterMessage="Sin resultados"  emptyMessage="Sin resultados"></p-dropdown>                        
                    <small class="p-invalid" *ngIf="submitted && address.idCountry <= 0">El país es requerido</small>
                </div>
        
                <div class="p-field p-col-12 p-sm-6 p-md-4 p-lg-3 p-xl-3 p-mt-1">
                    <label>Estado<span [ngStyle]="{'color':'red'}">*</span></label>
                    <p-dropdown [(ngModel)]="address.idState" [class]="submitted && address.idState <= 0 ? 'ng-dirty ng-invalid' : ''" [options]="statesList" (onChange)="changeloadMunicipalities(address.idState)" [disabled]="address.idCountry == null" placeholder="Seleccione..." appendTo="body" [filter]="true" emptyFilterMessage="Sin resultados"  emptyMessage="Sin resultados"></p-dropdown>                        
                    <small class="p-invalid" *ngIf="submitted && address.idState<= 0">El estado es requerido</small>
                </div>
        
                <div class="p-field p-col-12 p-sm-6 p-md-4 p-lg-3 p-xl-3 p-mt-1">
                    <label>Municipio<span [ngStyle]="{'color':'red'}">*</span></label>
                    <p-dropdown [(ngModel)]="address.idMunicipality"  [class]="submitted && address.idMunicipality <= 0 ? 'ng-dirty ng-invalid' : ''"[options]="municipalitiesList" (onChange)="changeloadCities(address.idMunicipality)" [disabled]="address.idState == null" placeholder="Seleccione..." appendTo="body" [filter]="true" emptyFilterMessage="Sin resultados"  emptyMessage="Sin resultados"></p-dropdown>
                    <small class="p-invalid" *ngIf="submitted && address.idMunicipality<= 0">El municipio es requerido</small>
                </div>
        
                <div class="p-field p-col-12 p-sm-6 p-md-4 p-lg-3 p-xl-3 p-mt-1">
                    <label>Ciudad<span [ngStyle]="{'color':'red'}">*</span></label>
                    <p-dropdown [(ngModel)]="address.idCity"  [class]="submitted && address.idCity <= 0 ? 'ng-dirty ng-invalid' : ''"[options]="citiesList" [disabled]="address.idMunicipality == null" placeholder="Seleccione..." appendTo="body"[filter]="true" emptyFilterMessage="Sin resultados"  emptyMessage="Sin resultados"></p-dropdown>                        
                    <small class="p-invalid" *ngIf="submitted && address.idCity<= 0">La ciudad es requerida</small>
                </div>
        
                <div class="p-field p-col-12 p-sm-6 p-md-4 p-lg-3 p-xl-3 p-mt-1">
                    <label>Tipo de dirección<span [ngStyle]="{'color':'red'}">*</span></label>
                    <p-dropdown [(ngModel)]="address.idAddressType" [class]="submitted && address.idAddressType <= 0 ? 'ng-dirty ng-invalid' : ''" [options]="addressTypeList" placeholder="Seleccione..." appendTo="body"  emptyMessage="Sin resultados" ></p-dropdown>                        
                    <small class="p-invalid" *ngIf="submitted && address.idAddressType<= 0">El tipo de dirección es requerido</small>
                </div>
        
                <div class="p-field p-col-12 p-sm-6 p-md-4 p-lg-3 p-xl-3 p-mt-1">
                    <label>Tipo de edificación<span [ngStyle]="{'color':'red'}">*</span></label>
                    <p-dropdown [(ngModel)]="address.idHousingType" [class]="submitted && address.idHousingType <= 0 ? 'ng-dirty ng-invalid' : ''" [options]="housingTypesList" placeholder="Seleccione..." appendTo="body"  emptyMessage="Sin resultados" ></p-dropdown>                        
                    <small class="p-invalid" *ngIf="submitted && address.idHousingType<= 0">El tipo de vivienda es requerido</small>
                </div>

                <div class="p-field p-col-12 p-sm-6 p-md-4 p-lg-3 p-xl-3 p-mt-1">
                    <label>Calle<span [ngStyle]="{'color':'red'}">*</span></label>                        
                    <input [(ngModel)]="address.street" [class]="submitted && (!address.street || !address.street.trim()) ? 'ng-dirty ng-invalid' : ''" type="text" appendTo="body" pInputText maxlength="100" [pKeyFilter]="acceptGuion" (paste)="_validations.noPaste($event)" (input)="_validations.toCapitalizeString($event)">
                    <small class="p-invalid" *ngIf="submitted && (!address.street || !address.street.trim())">La calle es requerida</small>
                </div>

                <div class="p-field p-col-12 p-sm-6 p-md-4 p-lg-3 p-xl-3 p-mt-1">
                    <label>Avenida</label>                        
                    <input [(ngModel)]="address.avenue" type="text" appendTo="body" pInputText maxlength="100" [pKeyFilter]="acceptGuion" (paste)="_validations.noPaste($event)" (input)="_validations.toCapitalizeString($event)">
                </div>                
                                        
                <div class="p-field p-col-12 p-sm-6 p-md-4 p-lg-3 p-xl-3 p-mt-1">
                    <label>Edificio</label>                        
                    <input [(ngModel)]="address.edifice" type="text" appendTo="body" pInputText maxlength="100" [pKeyFilter]="acceptGuion" (paste)="_validations.noPaste($event)" (input)="_validations.toCapitalizeString($event)">
                </div>
            
                <div class="p-field p-col-12 p-sm-6 p-md-4 p-lg-3 p-xl-3 p-mt-1">
                    <label>Piso</label>                        
                    <input [(ngModel)]="address.floor" type="text" pInputText maxlength="10" [pKeyFilter]="acceptGuion" (paste)="_validations.noPaste($event)" (input)="_validations.toCapitalizeString($event)">
                </div>
            
                <div class="p-field p-col-12 p-sm-6 p-md-4 p-lg-3 p-xl-3 p-mt-1">
                    <label>Apartamento</label>                        
                    <input [(ngModel)]="address.apartament" type="text" pInputText maxlength="10" [pKeyFilter]="acceptGuion" (paste)="_validations.noPaste($event)" (input)="_validations.toCapitalizeString($event)">
                </div>

                <div class="p-field p-col-12 p-sm-6 p-md-4 p-lg-3 p-xl-3 p-mt-1">
                    <label>Código postal</label>                                            
                    <input [(ngModel)]="address.postalCode" type="text" pInputText maxlength="10" [pKeyFilter]="acceptGuionNoSpace" (paste)="_validations.noPaste($event)">

                </div>
                                        
                <div class="p-field p-col-12 p-sm-12 p-md-8 p-lg-6 p-xl-6 p-mt-1">
                    <label>Referencia</label>                        
                    <textarea [(ngModel)]="address.references" type="text" pInputTextarea maxlength="400" [pKeyFilter]="acceptGuion" (paste)="_validations.noPaste($event)" (input)="_validations.toCapitalizeString($event)"></textarea>
                </div>  

                <div class="p-field p-col-12 p-sm-6 p-md-4 p-lg-3 p-xl-3 p-mt-1">
                    <label *ngIf="visibles==true">Latitud</label>                        
                    <p-inputNumber [(ngModel)]="address.latitude" [useGrouping]="false" disabled="false" *ngIf="visibles==true" [minFractionDigits]="7" [maxFractionDigits]="7"></p-inputNumber>
                </div>

                <div class="p-field p-col-12 p-sm-6 p-md-4 p-lg-3 p-xl-3 p-mt-1">
                    <label *ngIf="visibles==true">Longitud</label>                        
                    <p-inputNumber [(ngModel)]="address.length" [useGrouping]="false" disabled="false" *ngIf="visibles==true" [minFractionDigits]="7" [maxFractionDigits]="7" ></p-inputNumber>
                </div>                                 
            </div>
            <p-gmap  #gmap *ngIf="visibles==true" [options]="options" [overlays]="overlays" (onMapClick)="handleMapClick($event)" (onOverlayDragEnd)="handleDragEnd($event)" [style]="{'width':'100%','height':'320px'}" ></p-gmap>
        </div>
        
    </div>
    
    <ng-template pTemplate="footer">
        <p-button icon="pi pi-check" (click)="submit()" label="Aceptar" styleClass="p-button-info p-mr-2" ></p-button>
        <p-button icon="pi pi-ban" (click)="visible=false" label="Cancelar" styleClass="p-button-secondary"></p-button>
    </ng-template>
</p-dialog>
